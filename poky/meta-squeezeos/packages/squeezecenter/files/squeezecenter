#!/bin/sh

BASE=/usr/squeezecenter

# Some stuff does not seem to work without this
cd $BASE

case "$1" in
    start)
	echo "Starting SqueezeCenter"
	
	$BASE/slimserver.pl --pidfile /var/run/squeezecenter.pid --noweb --notranscoding --nosb1slimp3sync --noinfolog --nodebuglog --nostatistics &
	;;

    stop)
	echo "Stopping SqueezeCenter"

	killall -q slimserver.pl
	rm -f /var/run/squeezecenter.pid
	;;

    rescan)
	$0 stop
	
	echo "Running scanner"
	(
		$BASE/scanner.pl --rescan --json /etc/squeezecenter/scan.json --noinfolog --nodebuglog --nostatistics
	
		$0 start
	) &
	;;

    restart)
	(
	$0 stop
	sleep 2
	$0 start
	) &
	;;

    *)
	echo "Usage: $0 {start|stop|rescan|restart}"
	exit 1
esac

exit 0
