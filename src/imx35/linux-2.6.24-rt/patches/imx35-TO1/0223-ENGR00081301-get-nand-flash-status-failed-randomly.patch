From 1cc926340e72b5086e6b6d47e9a4a7db0c0ed4f2 Mon Sep 17 00:00:00 2001
From: Jason Liu <r64343@freescale.com>
Date: Sun, 22 Jun 2008 19:34:21 -0500
Subject: [PATCH] ENGR00081301 get nand flash status failed randomly

Get nand flash status failed randomly.

Signed-off-by: Jason Liu <r64343@freescale.com>
---
 drivers/mtd/nand/mxc_nd2.c |   15 ++-------------
 1 files changed, 2 insertions(+), 13 deletions(-)

diff --git a/drivers/mtd/nand/mxc_nd2.c b/drivers/mtd/nand/mxc_nd2.c
index 099ae78..4d351f9 100644
--- a/drivers/mtd/nand/mxc_nd2.c
+++ b/drivers/mtd/nand/mxc_nd2.c
@@ -382,19 +382,8 @@ static u16 get_dev_status(void)
 	return status;
 #else
 	volatile u16 *mainBuf = MAIN_AREA1;
-	volatile u32 store;
 	u8 val = 1;
 	u16 ret;
-	/* Issue status request to NAND device */
-
-	/* store the main area1 first word, later do recovery */
-	store = *((u32 *) mainBuf);
-	*(u32 *) mainBuf = 0x0;
-
-	/*
-	 * NFC buffer 1 is used for device status to prevent
-	 * corruption of read/write buffer on status requests.
-	 */
 
 	/* Set RBA bits for BUFFER1 */
 	NFC_SET_RBA(val);
@@ -409,8 +398,8 @@ static u16 get_dev_status(void)
 
 	/* Status is placed in first word of main buffer */
 	/* get status, then recovery area 1 data */
-	ret = mainBuf[0];
-	*((u32 *) mainBuf) = store;
+	ret = *mainBuf;
+
 	return ret;
 #endif
 }
-- 
1.5.4.4

