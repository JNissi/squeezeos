From c0c483e28ac50c8a918bfc811f3c361717409caf Mon Sep 17 00:00:00 2001
From: HV Rajanikanth <r66289@freescale.com>
Date: Tue, 22 Jan 2008 15:29:48 -0600
Subject: [PATCH] ENGR00053289 Porting mxc nand driver from 2 6 18 to 22

Porting mxc nand driver from kernel version 2.6.18 to 2.6.22
---
 drivers/pcmcia/mx31ads-pcmcia.c |    6 ++----
 1 files changed, 2 insertions(+), 4 deletions(-)

diff --git a/drivers/pcmcia/mx31ads-pcmcia.c b/drivers/pcmcia/mx31ads-pcmcia.c
index 7a3bf76..4cbfaf8 100644
--- a/drivers/pcmcia/mx31ads-pcmcia.c
+++ b/drivers/pcmcia/mx31ads-pcmcia.c
@@ -1045,14 +1045,12 @@ static int mx31ads_common_drv_pcmcia_probe(struct platform_device *pdev,
 
 	down(&mx31ads_pcmcia_sockets_lock);
 
-	skt = kmalloc(sizeof(struct mx31ads_pcmcia_socket), GFP_KERNEL);
+	skt = kzalloc(sizeof(struct mx31ads_pcmcia_socket), GFP_KERNEL);
 	if (!skt) {
 		ret = -ENOMEM;
 		goto out;
 	}
 
-	memset(skt, 0, sizeof(struct mx31ads_pcmcia_socket));
-
 	/*
 	 * Initialise the socket structure.
 	 */
@@ -1066,7 +1064,7 @@ static int mx31ads_common_drv_pcmcia_probe(struct platform_device *pdev,
 	skt->poll_timer.expires = jiffies + PCMCIA_POLL_PERIOD;
 
 	skt->irq = MX31ADS_PCMCIA_IRQ;
-	skt->dev = &pdev->dev;
+	skt->socket.dev.parent = &pdev->dev;
 	skt->ops = ops;
 
 	skt->clk = clk_get(NULL, "ahb_clk");
-- 
1.5.4.4

