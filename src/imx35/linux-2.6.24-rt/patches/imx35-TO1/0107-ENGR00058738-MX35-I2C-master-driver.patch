From 498421843a4e34770fd6607a20d5e0b019ac2197 Mon Sep 17 00:00:00 2001
From: Wu Guoxing <b02248@freescale.com>
Date: Fri, 28 Mar 2008 13:27:15 +0800
Subject: [PATCH] ENGR00058738 MX35 I2C master driver

MX35 I2C master driver

Signed-off-by: Guoxing Wu <b02248@freescale.com>
---
 arch/arm/mach-mx35/mx35_3stack_gpio.c |   33 ++++++++++++++++++++++++++++-----
 1 files changed, 28 insertions(+), 5 deletions(-)

diff --git a/arch/arm/mach-mx35/mx35_3stack_gpio.c b/arch/arm/mach-mx35/mx35_3stack_gpio.c
index 08c2c3f..645509b 100644
--- a/arch/arm/mach-mx35/mx35_3stack_gpio.c
+++ b/arch/arm/mach-mx35/mx35_3stack_gpio.c
@@ -192,25 +192,37 @@ EXPORT_SYMBOL(gpio_fec_inactive);
  */
 void gpio_i2c_active(int i2c_num)
 {
+
+#define PAD_CONFIG (PAD_CTL_HYS_SCHMITZ | PAD_CTL_PKE_ENABLE | PAD_CTL_PUE_PUD | PAD_CTL_ODE_OpenDrain)
+
 	switch (i2c_num) {
 	case 0:
 		mxc_request_iomux(MX35_PIN_I2C1_CLK, MUX_CONFIG_SION);
 		mxc_request_iomux(MX35_PIN_I2C1_DAT, MUX_CONFIG_SION);
 
-		mxc_iomux_set_pad(MX35_PIN_I2C1_CLK, 0x1e8);
-		mxc_iomux_set_pad(MX35_PIN_I2C1_DAT, 0x1e8);
+		mxc_iomux_set_pad(MX35_PIN_I2C1_CLK, PAD_CONFIG);
+		mxc_iomux_set_pad(MX35_PIN_I2C1_DAT, PAD_CONFIG);
 		break;
 	case 1:
 		mxc_request_iomux(MX35_PIN_I2C2_CLK, MUX_CONFIG_SION);
 		mxc_request_iomux(MX35_PIN_I2C2_DAT, MUX_CONFIG_SION);
 
-		mxc_iomux_set_pad(MX35_PIN_I2C2_CLK, 0x1e8);
-		mxc_iomux_set_pad(MX35_PIN_I2C2_DAT, 0x1e8);
+		mxc_iomux_set_pad(MX35_PIN_I2C2_CLK, PAD_CONFIG);
+		mxc_iomux_set_pad(MX35_PIN_I2C2_DAT, PAD_CONFIG);
 
 		break;
+	case 2:
+		mxc_request_iomux(MX35_PIN_TX3_RX2, MUX_CONFIG_ALT1);
+		mxc_request_iomux(MX35_PIN_TX2_RX3, MUX_CONFIG_ALT1);
+		mxc_iomux_set_pad(MX35_PIN_TX3_RX2, PAD_CONFIG);
+		mxc_iomux_set_pad(MX35_PIN_TX2_RX3, PAD_CONFIG);
+		break;
 	default:
 		break;
 	}
+
+#undef PAD_CONFIG
+
 }
 
 EXPORT_SYMBOL(gpio_i2c_active);
@@ -222,7 +234,18 @@ EXPORT_SYMBOL(gpio_i2c_active);
  */
 void gpio_i2c_inactive(int i2c_num)
 {
-	/*TODO:complete inactive function */
+	switch (i2c_num) {
+	case 0:
+		break;
+	case 1:
+		break;
+	case 2:
+		mxc_request_iomux(MX35_PIN_TX3_RX2, MUX_CONFIG_GPIO);
+		mxc_request_iomux(MX35_PIN_TX2_RX3, MUX_CONFIG_GPIO);
+		break;
+	default:
+		break;
+	}
 }
 
 EXPORT_SYMBOL(gpio_i2c_inactive);
-- 
1.5.4.4

